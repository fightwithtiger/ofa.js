/*!
* ofa v2.4.2
* https://github.com/kirakiray/ofa.js
* 
* (c) 2018-2020 YAO
* Released under the MIT License.
*/(e=>{"use strict";(e=>{const t=()=>Math.random().toString(32).substr(2);let a=Object.prototype.toString;const r=e=>a.call(e).toLowerCase().replace(/(\[object )|(])/g,""),s=e=>void 0===e,n=e=>r(e).includes("function"),i=e=>JSON.parse(JSON.stringify(e)),l=(()=>{if(null!==document.currentScript.getAttribute("debug")){let e=new Map;return(a,r)=>{r||(r=t());let s=e.get(r);clearTimeout(s),e.set(r,setTimeout(()=>{a(),e.delete(r)}))}}let e=!1,a=new Map,r=setTimeout;return"object"==typeof process&&process.nextTick&&(r=process.nextTick),(s,n)=>{e||(e=!0,r(()=>{a.size&&a.forEach(({key:e,fun:t})=>{t(),a.delete(e)}),a.clear(),e=!1})),n||(n=t()),a.set(n,{key:n,fun:s})}})(),o=(e,a,r,s)=>{let n;n=e._modifyId?e._modifyId:t(),D(e,_).push(n),d(e);let l=new v({type:"update",target:e[j]||e});Object.defineProperties(l,{trend:{get:()=>new A(l)}}),s&&Object.assign(l,s),l.modify={name:a,args:r.map(e=>e instanceof I?e.object:e instanceof Object?i(e):e),mid:n},e.emit(l)};let c,h=new Set;const d=e=>{e[_].length<50||(clearTimeout(c),h.add(e),c=setTimeout(()=>{let e=Array.from(h);setTimeout(()=>{e.forEach(e=>d(e))},1e3),h.forEach(e=>{let t=e[_];t.splice(0,Math.ceil(t.length/2))}),h.clear()},3e3))},p=e=>{if(!(e instanceof I))return;let t=e[E];if(t&&(t.index=void 0,t.parent=void 0),e instanceof K){let{mappingXData:a}=e,r=a[$].find(e=>e.data===t),{leftUpdate:s,rightUpdate:n}=r;e.off("update",n),a.off("update",s),t.mappingXData=null}if(t[P])for(let[e,a]of t[P])t.unsync(e);t[$]&&(t[$].forEach(e=>{let{data:a,leftUpdate:r,rightUpdate:s}=e;a.off("update",s),t.off("update",r),a.mappingXData=null}),t[$].splice(0)),t[O]&&t[O].clear(),t[g]&&t[g].clear()},u=(e,t)=>{let a=e;switch(r(e)){case"object":case"array":a=new I(e,t)}return a},f=(e,t)=>{if(e instanceof Array)return e.map(e=>f(e,t));if(e instanceof Object){let a={},r=[];return Object.keys(e).forEach(s=>{/\D/.test(s)?a[s]=f(e[s]):r.push(f(e[s],t))}),r.length&&(a[t]=r),a}return e},g=Symbol("events"),m=(e,t)=>{let a=t[g];a||(a=new Map,Object.defineProperty(t,g,{value:a}));let r=a.get(e);return r||(r=[],a.set(e,r)),r},b=(e,t)=>{let a;return e instanceof v?e=(a=e).type:a=new v({type:e,target:t[j]||t}),a};class y{constructor(e={}){Object.defineProperties(this,{parent:{writable:!0,value:e.parent,configurable:!0},index:{writable:!0,value:e.index,configurable:!0}})}on(e,t,a){this.addListener({type:e,data:a,callback:t})}one(e,t,a){this.addListener({count:1,type:e,data:a,callback:t})}addListener(e={}){let{type:t,data:a,callback:r,count:n=1/0,eventId:i}=e;if(!t)throw{desc:"addListener no type",options:e};let l=t.split("#");1 in l&&(t=l[0],i=l[1]);let o=m(t,this);s(i)||Array.from(o).some(e=>{if(e.eventId===i){let t=o.indexOf(e);return t>-1&&o.splice(t,1),!0}}),r&&o.push({type:t,data:a,callback:r,eventId:i,count:n})}off(e,t){if(e)if(t){let a=m(e,this),r=a.findIndex(e=>e.callback==t);r>-1&&a.splice(r,1)}else this[g]&&this[g].delete(e)}emitHandler(e,t){let a=b(e,this);e=a.type;let r=m(e,this),s=[];return a.currentTarget=this[j]||this,r.some(e=>{e.data&&(a.data=e.data),e.eventId&&(a.eventId=e.eventId);let r={self:this,event:a,emitData:t};if((e.before?e.before(r):1)&&e.callback.call(this[j]||this,a,t),e.after&&e.after(r),delete a.data,delete a.eventId,e.count--,e.count||s.push(e),a.cancel)return!0}),delete a.currentTarget,s.forEach(e=>{let t=r.indexOf(e);t>-1&&r.splice(t,1)}),a}emit(e,t){let a=this.emitHandler(e,t);if(a.bubble&&!a.cancel){let{parent:e}=this;e&&(a.keys.unshift(this.index),e.emit(a,t))}}}class v extends y{constructor(e){super(),this.type=e.type,this.target=e.target,this._bubble=!0,this._cancel=!1,this.keys=[]}get bubble(){return this._bubble}set bubble(e){this._bubble!==e&&(this.emitHandler("set-bubble",e),this._bubble=e)}get cancel(){return this._cancel}set cancel(e){this._cancel!==e&&(this.emitHandler("set-cancel",e),this._cancel=e)}}const w=/^_.+|^index$|^length$|^object$|^getData$|^setData$/,x=/^parent$|^index$|^length$|^object$/;let k={get:(e,t,a)=>"symbol"==typeof t||w.test(t)?Reflect.get(e,t,a):e.getData(t),set:(e,t,a,r)=>"symbol"==typeof t?Reflect.set(e,t,a,r):e.setData(t,a)};const j=Symbol("proxyThis"),E=Symbol("XDataSelf"),O=Symbol("WatchHost"),_=Symbol("ModifyIDS"),P=Symbol("SyncHost"),$=Symbol("VirDataHost"),D=(e,t)=>{let a=e[t];if(!a){switch(t){case O:case P:a=new Map;break;case _:case $:a=[]}Object.defineProperty(e,t,{value:a})}return a},S="undefined"!=typeof Element;class I extends y{constructor(e,t={}){super(t);let a=new Proxy(this,k),r=0;Object.keys(e).forEach(t=>{let a=e[t];/^\_/.test(t)||S&&a instanceof Element?Object.defineProperty(this,t,{configurable:!0,writable:!0,value:a}):(/\D/.test(t)||(t=parseInt(t))>=r&&(r=t+1),a instanceof Object?this[t]=new I(a,{parent:this,index:t}):this[t]=a)}),Object.defineProperties(this,{[E]:{get:()=>this},[j]:{value:a},_modifyId:{value:null,writable:!0},length:{configurable:!0,writable:!0,value:r}})}setData(e,t){if(x.test(e))return console.warn("you can't set this key in XData => ",e),!1;if(/^_.+/.test(e))return Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t}),!0;let a=this[E];if(/\./.test(e)){let r=e.split("."),s=r.length-1;return r.some((t,r)=>{if(r==s)return e=t,!0;a=a[t]}),a.setData(e,t),!0}if("string"===r(e)){let r=a[e];return t===r||(r instanceof I&&(r=r.object),t instanceof I?((t=t[E]).remove(),t.parent=a,t.index=e):t instanceof Object&&(t=u(t,{parent:a,index:e})),a[e]=t,o(a,"setData",[e,t],{oldValue:r}),!0)}if(e instanceof Object){let t=e;return Object.keys(t).forEach(e=>{let r=t[e];a.setData(e,r)}),!0}}getData(e){let t=this[e];return t instanceof I&&(t=t[j]),t}remove(e){if(s(e)){let{parent:e}=this;e?e.remove(this.index):p(this)}else{let t=this[e];/\D/.test(e)?(delete this[e],p(t),o(this,"remove",[e])):this.splice(parseInt(e),1)}}add(e){!this.includes(e)&&this.push(e)}delete(e){let t=this.indexOf(e);t>-1&&this.splice(t,1)}has(e){return this.includes(e)}clear(){this.splice(0,this.length)}before(e){if(/\D/.test(this.index))throw{text:"It must be an array element",target:this,index:this.index};return this.parent.splice(this.index,0,e),this}after(e){if(/\D/.test(this.index))throw{text:"It must be an array element",target:this,index:this.index};return this.parent.splice(this.index+1,0,e),this}clone(){return u(i(this))[j]}emitHandler(e,t){let a=b(e,this);if("update"===a.type){let{_unBubble:e,_update:t,_unpush:r}=this,{fromKey:s}=a.trend;(!1===t||e&&e.includes(s))&&(a.bubble=!1),r&&r.includes(s)&&Object.defineProperty(a,"_unpush",{value:!0})}return y.prototype.emitHandler.call(this,a,t),a}noStanz(e={childKey:"children"}){return f(this.object,e.childKey)}get object(){let e={},t=!0,{_unBubble:a=[]}=this;return Object.keys(this).forEach(r=>{if(/^_/.test(r)||!/\D/.test(r)||a.includes(r))return;let s=this[r];if(s instanceof I){if(!1===s._update)return;s=s.object}e[r]=s,t=!1}),this.forEach((t,a)=>{t instanceof I&&(t=t.object),e[a]=t}),t&&(e.length=this.length,e=Array.from(e)),e}get string(){return JSON.stringify(this.object)}get root(){let e=this;for(;e.parent;)e=e.parent;return e}get prev(){if(!/\D/.test(this.index)&&this.index>0)return this.parent.getData(this.index-1)}get next(){if(!/\D/.test(this.index))return this.parent.getData(this.index+1)}getTarget(e){let t=this;return e.length&&e.forEach(e=>{t=t[e]}),t}seek(e){let t=r(e);if("function"===t){let t=[],a=a=>{if(a instanceof I){e(a)&&t.push(a);let r=a.seek(e);t=[...t,...r]}};return Object.keys(this).forEach(e=>{/\D/.test(e)&&a(this[e])}),this.forEach(a),a=null,t}if("string"===t){let t,a=(e=e.replace(/[\[\]]/g,"")).split("=");if(2==a.length){let[e,r]=a;t=(t=>t[e]==r)}else{let[e]=a;t=(t=>Object.keys(t).includes(e))}return this.seek(t)}}watch(e,t,a){let s,n=r(e);if("object"===n)return void Object.keys(e).forEach(t=>{this.watch(t,e[t])});/function/.test(n)&&(a=t,t=e,e=""),s=""===e?"watchSelf":e instanceof RegExp?"watchKeyReg":/\[.+\]/.test(e)?"seekData":/\./.test(e)?"watchPointKey":"watchKey";let i=D(this,O).get(e);i||(i=new Set,D(this,O).set(e,i));let o,c={trends:[],callback:t,expr:e};i.add(c);let h=this[j];switch(s){case"watchSelf":o=(e=>{c.trends.push(e.trend),l(()=>{t.call(h,{trends:Array.from(c.trends)},h),c.trends.length=0},c)}),!0===a&&t.call(h,{trends:[]},h);break;case"watchKey":case"watchKeyReg":o=(a=>{let{trend:r}=a;("watchKeyReg"===s&&e.test(r.fromKey)||r.fromKey==e)&&(c.trends.push(a.trend),c.cacheOld||(c._oldVal=a.oldValue instanceof I?a.oldValue.object:a.oldValue,c.cacheOld=!0),l(()=>{let a=this[e];t.call(h,{expr:e,val:a,old:c._oldVal,trends:Array.from(c.trends)},a),c.trends.length=0,c._oldVal=c.cacheOld=!1},c))}),!0===a&&t.call(h,{expr:e,val:h[e],trends:[]},h[e]);break;case"watchPointKey":let r=e.split("."),n=r[0],i=this.getTarget(r);o=(a=>{let{trend:s}=a;if(s.fromKey==n){let n;try{n=this.getTarget(r)}catch(a){}n!==i&&(c.trends.push(s),l(()=>{(n=this.getTarget(r))!==i&&t.call(h,{expr:e,old:i,val:n,trends:Array.from(c.trends)},n),c.trends.length=0},c))}}),!0===a&&t.call(h,{expr:e,val:i},i);break;case"seekData":let d=h.seek(e);o=(a=>{l(()=>{let a=h.seek(e),r=1;a.length===d.length?a.some(e=>{if(!d.includes(e))return r=0,!0}):r=0,!r&&t.call(h,{expr:e,old:d,val:a},a),d=a},c)}),!0===a&&t.call(h,{expr:e,old:d,val:d},d)}return this.on("update",o),c.updateMethod=o,this}unwatch(e,t){let a=r(e);if("object"===a)return Object.keys(e).forEach(t=>{this.unwatch(t,e[t])}),this;/function/.test(a)&&(t=e,e="");let s=D(this,O).get(e);if(s){let a=Array.from(s).find(a=>a.callback===t&&a.expr===e);a&&(this.off("update",a.updateMethod),s.delete(a),!s.size&&D(this,O).delete(e))}return this}entrend(e){let{mid:t,keys:a,name:r,args:s,_unpush:n}=e;if(n)return;let{_unpull:i}=this,l=L(e);if(i&&i.includes(l))return;if(!t)throw{text:"Illegal trend data"};let o=this.getTarget(a)[E];return!D(o,_).includes(t)&&(o._modifyId=t,o[r](...s),o._modifyId=null,!0)}}const L=e=>{let t=e.keys[0];return!s(t)||"setData"!==e.name&&"remove"!==e.name||(t=e.args[0]),t};class A{constructor(e){if(e instanceof v){let{modify:{name:t,args:a,mid:r},keys:s}=i(e),{_unpush:n}=e;n&&Object.defineProperty(this,"_unpush",{value:!0}),Object.assign(this,{name:t,args:a,mid:r,keys:s})}else Object.assign(this,e)}get string(){return JSON.stringify(this)}get finalSetterKey(){switch(this.name){case"remove":case"setData":return this.args[0]}}get fromKey(){return L(this)}set fromKey(e){let t=this.keys[0];s(t)?"setData"!==this.name&&"remove"!==this.name||(this.args[0]=e):this.keys[0]=e}}const T=(e,t,a)=>{t.trends.forEach(t=>{t.fromKey===e&&a.entrend(t)})},C=(e,t,a)=>{t.trends.forEach(t=>{e.includes(t.fromKey)&&a.entrend(t)})},M=(e,t,a)=>{i(t.trends).forEach(t=>{t=new A(t);let{fromKey:r}=t;if(!s(r)){let s=e.get(r);s&&(t.fromKey=s,a.entrend(t))}})},N=e=>(e instanceof I&&(e=e.object),e),H=(e,t,a)=>{Object.keys(e).forEach(r=>{let s=e[r];if(s instanceof Object){t[r]||(t.setData?t.setData(r,{}):t[r]={});let e=t[r];H(s,e,a)}else{let n=a([r,s],{self:e,target:t});if(n){let[e,a]=n;t[e]=a}}})},U=(e,t,a)=>{let{trend:r}=t;if(r){switch(r.name){case"setData":let e=r.args[1];if(e instanceof Object){let t={};H(e,t,a),r.args[1]=t}else s(e)||(r.args=a(r.args,{event:t}));break;default:r.args=r.args.map(e=>{let t=e;return e instanceof Object&&H(e,t={},a),t})}e.entrend(r)}},R={sync(e,t,a){let s,n;switch(r(t)){case"string":a&&e.setData(t,N(this[t])),s=(a=>T(t,a,e)),n=(e=>T(t,e,this));break;case"array":a&&t.forEach(t=>{e.setData(t,N(this[t]))}),s=(a=>C(t,a,e)),n=(e=>C(t,e,this));break;case"object":let i=new Map(Object.entries(t)),l=new Map(Object.entries(t).map(e=>e.reverse()));a&&Object.keys(t).forEach(a=>{e.setData(t[a],N(this[a]))}),s=(t=>M(i,t,e)),n=(e=>M(l,e,this));break;default:if(a){let t=this.object;Object.keys(t).forEach(a=>{e.setData(a,t[a])})}s=(t=>t.trends.forEach(t=>e.entrend(t))),n=(e=>e.trends.forEach(e=>this.entrend(e)))}this.watch(s),e.watch(n);let i=D(this,P);i.has(e)&&this.unsync(e),i.set(e,{selfWatch:s,oppWatch:n}),D(e,P).set(this,{selfWatch:n,oppWatch:s})},unsync(e){let t=D(this,P).get(e);if(t){let{selfWatch:a,oppWatch:r}=t;this.unwatch(a),e.unwatch(r),D(this,P).delete(e),D(e,P).delete(this)}},virData(e,t){let a,s,n=new K(this[E],{}),i=r(e),l=e;if("object"==i)if("mapKey"in l){let a=Object.entries(l.mapKey),r=new Map(a),s=new Map(a.map(e=>e.reverse()));e=(([e,t])=>r.has(e)?[r.get(e),t]:[e,t]),t=(([e,t])=>s.has(e)?[s.get(e),t]:[e,t])}else if("mapValue"in l){let a=l.key,r=Object.entries(l.mapValue),s=new Map(r),n=new Map(r.map(e=>e.reverse()));e=(([e,t])=>e===a&&s.has(t)?[e,s.get(t)]:[e,t]),t=(([e,t])=>e===a&&n.has(t)?[e,n.get(t)]:[e,t])}return H(this,n,e),this.on("update",a=(t=>U(n,t,e))),n.on("update",s=(e=>U(this,e,t))),D(this,$).push({data:n,leftUpdate:a,rightUpdate:s}),n[j]}};Object.keys(R).forEach(e=>{Object.defineProperty(I.prototype,e,{writable:!0,value:R[e]})});class K extends I{constructor(e,...t){super(...t),Object.defineProperty(this,"mappingXData",{writable:!0,value:e})}}["concat","every","filter","find","findIndex","forEach","map","slice","some","indexOf","lastIndexOf","includes","join"].forEach(e=>{let t=Array.prototype[e];t&&Object.defineProperty(I.prototype,e,{value(...e){return t.apply(this,e)}})}),["pop","push","reverse","splice","shift","unshift"].forEach(e=>{let t=Array.prototype[e];t&&Object.defineProperty(I.prototype,e,{value(...a){let r=[],s=this[E],n=s.object;a.forEach(e=>{if(e instanceof I){let t=e[E];t.remove(),r.push(t)}else{let t=u(e,{parent:s});r.push(t)}});let i=t.apply(s,r);switch(s.forEach((e,t)=>{e instanceof I&&(e.index=t)}),e){case"shift":case"pop":i instanceof I&&p(i);break;case"splice":i.forEach(e=>{e instanceof I&&p(e)})}return o(s,e,a,{oldValue:n}),i}})}),Object.defineProperties(I.prototype,{sort:{value(e){let t=[],a=this[E],r=a.object,s=Array.from(a);if(n(e)||!e){Array.prototype.sort.call(a,e),a.forEach((e,t)=>{e instanceof I&&(e.index=t)}),t=[s.map(e=>e.index)],s=null}else e instanceof Array&&(e.forEach((e,t)=>{(a[e]=s[t]).index=e}),t=[e]);return o(a,"sort",t,{oldValue:r}),this}}});const F=(e,t)=>{if(e===t)return!0;if(e===document)return!1;let a=document.createElement("template"),r=`<${e.tagName.toLowerCase()} ${Array.from(e.attributes).map(e=>e.name+'="'+e.value+'"').join(" ")} />`;return a.innerHTML=r,!!a.content.querySelector(t)},V=e=>{if(!e.tag)throw console.error("this data need tag =>",e),"";let t=document.createElement(e.tag);e.class&&t.setAttribute("class",e.class),e.slot&&t.setAttribute("slot",e.slot),e.text&&(t.textContent=e.text);let{data:a}=e;if(a&&Object.keys(a).forEach(e=>{let r=a[e];t.dataset[e]=r}),t.xvele){let a=be(t);a[Z].forEach(t=>{let r=e[t];s(r)||(a[t]=r)})}let r=0;for(;r in e;){let a=V(e[r]);t.appendChild(a),r++}return t},W=e=>{let t;if(e instanceof ae)return e.ele;switch(r(e)){case"string":/\<.+\>/.test(e)&&(t=(t=(e=>{let t=document.createElement("div");return t.innerHTML=e,Array.from(t.childNodes).filter(function(e){if(!(e instanceof Text)||e.textContent&&e.textContent.trim())return t.removeChild(e),e})})(e))[0]);break;case"object":t=V(e);break;default:(e instanceof Element||e instanceof DocumentFragment||e instanceof Document)&&(t=e)}return t},B=(e,t)=>{let a=e.querySelectorAll(t);return a?Array.from(a):[]},X=e=>(/\-/.test(e)&&(e=e.replace(/\-[\D]/g,e=>e.substr(1).toUpperCase())),e),z=e=>(/[A-Z]/.test(e)&&(e=e.replace(/[A-Z]/g,e=>"-"+e.toLowerCase())),e),q={get:function(e,t){return e._ele.getAttribute(z(t))},set:function(e,t,a){return null===a?e._ele.removeAttribute(t):e._ele.setAttribute(z(t),String(a)),!0}};const J=e=>{let t=e.__p_attrs;return t||(e.__p_attrs=t=new Proxy(new class{constructor(e){Object.defineProperties(this,{_ele:{get:()=>e}})}}(e),q)),t},Z=Symbol("cansetkeys"),G=Symbol("orignEvents"),Q=new Set(["text","html","display","style"]),Y=new Set(["text","html"]),ee=new Set(["parent","index","slot"]),te=I.prototype.setData;class ae extends I{constructor(e){super({}),delete this.parent,delete this.index,delete this.length,Object.defineProperties(e,{__xhear__:{value:this,configurable:!0}});let t=e.tagName?e.tagName.toLowerCase():"";Object.defineProperties(this,{tag:{enumerable:!0,value:t},ele:{value:e},[G]:{writable:!0,value:""}})}get parent(){let{parentNode:e}=this.ele;if(!(e instanceof DocumentFragment))return e&&e!==document?ye(e):null}get index(){let{ele:e}=this;return Array.from(e.parentNode.children).indexOf(e)}get length(){return this.ele.children.length}get class(){return this.ele.classList}get data(){return this.ele.dataset}get css(){return getComputedStyle(this.ele)}get position(){return{top:this.ele.offsetTop,left:this.ele.offsetLeft}}get offset(){let e={top:0,left:0},t=this.ele;for(;t&&t!==document;)e.top+=t.offsetTop,e.left+=t.offsetLeft,t=t.offsetParent;return e}get width(){return parseInt(getComputedStyle(this.ele).width)}get height(){return parseInt(getComputedStyle(this.ele).height)}get innerWidth(){return this.ele.clientWidth}get innerHeight(){return this.ele.clientHeight}get offsetWidth(){return this.ele.offsetWidth}get offsetHeight(){return this.ele.offsetHeight}get outerWidth(){let e=getComputedStyle(this.ele);return this.ele.offsetWidth+parseInt(e["margin-left"])+parseInt(e["margin-right"])}get outerHeight(){let e=getComputedStyle(this.ele);return this.ele.offsetHeight+parseInt(e["margin-top"])+parseInt(e["margin-bottom"])}get text(){return this.ele.textContent}set text(e){this.ele.textContent=e}get html(){return this.ele.innerHTML}set html(e){this.ele.innerHTML=e}get display(){return getComputedStyle(this.ele).display}set display(e){this.ele.style.display=e}get style(){return this.ele.style}set style(e){if("string"==r(e))return void(this.ele.style=e);let{style:t}=this,a=Array.from(t),s=Object.keys(e);a.forEach(e=>{s.includes(e)||(t[e]="")}),Object.assign(t,e)}get $shadow(){let{shadowRoot:e}=this.ele;return e&&ye(e)}get $root(){let e=this.ele;for(;e.parentNode;)e=e.parentNode;return e&&ye(e)}get $host(){let{$root:e}=this;return e&&e.ele.host&&ye(e.ele.host)}get attrs(){return J(this.ele)}setData(e,t){if(ee.has(e))return console.warn("can't set this key => ",e),!1;e=X(e);let a=this[E],r=this[Z];if(Q.has(e)){let r=a[e];return a[e]=t,Y.has(e)&&o(a,"setData",[e,t],{oldValue:r}),!0}if(r&&r.has(e)||/^_.+/.test(e))return te.call(a,e,t);if(!/\D/.test(e)){let r=ve(t),s=a.ele.children[e];if(s){let n=a.getData(e).object;a.ele.insertBefore(r.ele,s),a.ele.removeChild(s),o(a,"setData",[e,t],{oldValue:n})}else a.ele.appendChild(r.ele),o(a,"setData",[e,t],{oldValue:void 0})}return!1}getData(e){e=X(e);let t,a=this[E];return/\D/.test(e)?t=a[e]:(t=a.ele.children[e])&&(t=ye(t)),t instanceof I&&(t=t[j]),t}siblings(e){let t=Array.from(this.ele.parentElement.children),a=t.indexOf(this.ele);return t.splice(a,1),e&&(t=t.filter(t=>{if(F(t,e))return!0})),t.map(e=>ye(e))}empty(){return this.splice(0,this.length),this}parents(e){let t=[],a=this.parent;if(e){if("string"!=r(e)){if(e instanceof ae&&(e=e.ele),e instanceof Element)for(;a;){if(a.ele==e)return!0;a=a.parent}return!1}for(;a;)F(a.ele,e)&&t.push(a),a=a.parent}else for(;a;)t.push(a),a=a.parent;return t}is(e){return F(this.ele,e)}$(e){let t=this.ele.querySelector(e);if(t)return ye(t)}all(e){return B(this.ele,e).map(e=>ye(e))}clone(){let e=ye(this.ele.cloneNode(!0));return Object.keys(this).forEach(t=>{"tag"!==t&&(e[t]=this[t])}),e}viewData(){let e=u({});return this.all("[xv-vd]").forEach(t=>{let a=t.attrs.xvVd;if(t.xvele){let r={};if(/ to /.test(a)){a.split(",").forEach(a=>{let s=a.split("to");if(2==s.length){let a=s[0].trim(),n=s[1].trim();e[n]=t[a],r[n]=a}})}else a=a.trim(),e[a]=t.value,r[a]="value";e.sync(t,r)}else{let{ele:a}=t;"checked"in a?(e[vd]=a.checked,e.watch(vd,t=>{a.checked=e[vd]}),a.addEventListener("change",t=>{e[vd]=a.checked})):(e[vd]=a.value,e.watch(vd,t=>{a.value=e[vd]}),a.addEventListener("change",t=>{e[vd]=a.value}),a.addEventListener("input",t=>{e[vd]=a.value}))}t.attrs.xvVd=null}),e}extend(e){return Object.keys(e).forEach(t=>{let{get:a,set:r,value:s}=Object.getOwnPropertyDescriptor(e,t);s?Object.defineProperty(this,t,{value:s}):(Object.defineProperty(this,t,{get:a,set:r}),r&&Q.add(t))}),this}}const re=ae.prototype,se=e.MouseEvent||Event,ne=e.TouchEvent||Event,ie=new Map([["click",se],["mousedown",se],["mouseup",se],["mousemove",se],["mouseenter",se],["mouseleave",se],["touchstart",ne],["touchend",ne],["touchmove",ne]]),le=e=>{let t,a,s,n=e[0];if("object"==r(n)){let e=n;n=e.event,a=e.callback,s=e.data,t=e.selector}else switch(r(e[1])){case"string":t=e[1],a=e[2],s=e[3];break;default:a=e[1],s=e[2]}return{eventName:n,selector:t,callback:a,data:s}};function oe(e,t={count:1/0}){let{eventName:a,selector:r,callback:s,data:n}=le(e),i=this[G]||(this[G]=new Map);if(!i.has(a)){let e=e=>{let r,{_para_x_eve_:n}=e;if(n){(r=n).target.ele!==e.target&&(r.target=ye(e.target));let t=[],a=e.target;for(;a!==e.currentTarget;){let e=a.parentNode;if(!e)break;let r=Array.from(e.children).indexOf(a);t.unshift(r),a=e}r.keys=t}else(r=new v({type:a,target:ye(e.target)})).on("set-bubble",(t,a)=>!a&&e.stopPropagation()),r.on("set-cancel",(t,a)=>a&&e.stopImmediatePropagation()),r.preventDefault=e.preventDefault.bind(e),e._para_x_eve_=r;r.originalEvent=e,this.emitHandler(r),r.originalEvent=null,t.count--,t.count||this.off(a,s)};i.set(a,e),this.ele.addEventListener(a,e)}if(this.addListener({type:a,count:t.count,data:n,callback:s}),r){m(a,this).forEach(e=>{e.callback==s&&(e.before=(e=>{let t,{self:a,event:s}=e,n=s.target;return(t=n.is(r)?n:n.parents(r)[0])?(Object.assign(s,{selector:r,delegateTarget:t}),1):0}),e.after=(e=>{let{self:t,event:a}=e;delete a.selector,delete a.delegateTarget}))})}}re.extend({on(...e){return oe.call(this,e),this},off(...e){let t=e[0],a=m(t,this);if(I.prototype.off.apply(this,e),!a.length){let e=this[G]||(this[G]=new Map),a=e.get(t);a&&this.ele.removeEventListener(t,a),e.delete(t)}return this},one(...e){return oe.call(this,e,{count:1}),this},trigger(e,t){let a,r={bubbles:!0,cancelable:!0};if(Object.assign(r,t),e instanceof Event)a=e;else{a=new(ie.get(e)||Event)(e,{bubbles:r.bubbles,cancelable:r.cancelable})}return this.ele.dispatchEvent(a),this}}),["concat","every","filter","find","findIndex","forEach","map","slice","some","indexOf","lastIndexOf","includes","join"].forEach(e=>{let t=Array.prototype[e];t&&Object.defineProperty(re,e,{value(...e){return t.apply(Array.from(this.ele.children).map(e=>ye(e)),e)}})});const ce=(e,t,a,r=[])=>{let s=e[E],n=[],i=s.ele,{children:l}=i,c=a;for(;c>0;){let e=l[t];if(!e)break;n.push(ye(e)),i.removeChild(e),c--}let h=l[t];if(r.length){let e=document.createDocumentFragment();r.forEach(t=>e.appendChild(W(t))),t>=0&&h?i.insertBefore(e,h):i.appendChild(e)}return o(s,"splice",[t,a,...r]),n},he=(e,t)=>{let a=e[E],{ele:r}=a,s=Array.from(r.children),n=document.createDocumentFragment();t.forEach(e=>{let t=s[e];t.xvele&&(t[pe]=1),n.appendChild(t)}),r.appendChild(n),s.forEach(e=>e.xvele&&(e[pe]=0))};re.extend({push(...e){let t=document.createDocumentFragment();return e.forEach(e=>{let a=W(e);t.appendChild(a)}),this.ele.appendChild(t),o(this[E],"push",e),this.length},splice(e,t,...a){return ce(this,e,t,a)},unshift(...e){return ce(this,0,0,e),this.length},shift(){return ce(this,0,1)},pop(){return ce(this,this.length-1,1)},reverse(){let e=Array.from(this.ele.children),t=e.length;he(this,e.map((e,a)=>t-1-a)),o(this[E],"reverse",[])},sort(e){if(n(e)){let a=Array.from(this.ele.children).map(e=>ye(e)),r=Array.from(a);a.sort(e),e=[];let s=t();a.forEach(t=>{let a=r.indexOf(t);r[a]=s,e.push(a)})}e instanceof Array&&he(this,e),o(this[E],"sort",[e])}});const de=new Map,pe=Symbol("runArray"),ue=(t(),e=>/[ \|\&\(\)\?\:\!]/.test(e.trim())),fe=e=>new Function("$event",`with(this){return ${e}}`),ge=({target:e,callback:t,expr:a})=>{if(ue(a)){let r=fe(a);e.watch(a=>t(r.call(e[j])))}else e.watch(a,(e,a)=>t(a))},me=(e,a)=>{let r=be(e);a.proto&&r.extend(a.proto);let n,{temp:i}=a;if(i){n=e.attachShadow({mode:"open"});var o=(i=i.replace(/<!--.+?-->/g,"")).match(/{{.+?}}/g);o&&o.forEach(e=>{var t=/{{(.+?)}}/.exec(e);t&&(i=i.replace(e,`<xv-span xvkey="${t[1].trim()}"></xv-span>`))}),n.innerHTML=i,B(n,"[xv-if]").forEach(e=>{if(e.getAttribute("xv-tar"))return void console.error({target:e,desc:"xv-if cannot be used with xv-tar"});var t=document.createTextNode("");e.parentNode.insertBefore(t,e);let a=e;ge({target:r,expr:e.getAttribute("xv-if"),callback(r){r?a||(a=e.cloneNode(),t.parentNode.insertBefore(a,t)):(a.parentNode.removeChild(a),a=null)}})}),B(n,"[xv-tar]").forEach(e=>{let t=e.getAttribute("xv-tar");Object.defineProperty(r,"$"+t,{get:()=>ye(e)})}),B(n,"xv-span").forEach(e=>{var t=document.createTextNode("");e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e),ge({target:r,expr:e.getAttribute("xvkey"),callback(e){t.textContent=e}})}),B(n,"[xv-show]").forEach(e=>{ge({target:r,expr:e.getAttribute("xv-show"),callback(t){e.style.display=t?"":"none"}})}),B(n,"*").forEach(e=>{let t="";Array.from(e.attributes).forEach(a=>{let{name:s,value:n}=a,i=n;s=X(s);const l=ue(i);let o=/^:(.+)/.exec(s);if(o){let a=o[1],c=/^#(.+)/.exec(a);if(c&&(a=c[1],c=!!c,l))throw{desc:"Function expressions cannot be used for sync binding"};if(l){let t=fe(i);r.watch(s=>{let n=t.call(r[j]);e.xvele?(n instanceof ae&&(n=n.object),be(e).setData(a,n)):e.setAttribute(a,n)})}else{let t;e.xvele?(t=((t,r)=>{r instanceof ae&&(r=r.object),be(e).setData(a,r)}),c&&be(e).watch(a,(e,t)=>{r.setData(i,t)})):t=((t,r)=>{e.setAttribute(a,r)}),r.watch(i,t)}e.removeAttribute(o[0]),t+=`${s}=${n},`}t&&(t=t.slice(0,-1),e.setAttribute("xv-binding-expr",t));let c=/^@(.+)/.exec(s);if(c){let t,[a,...s]=c[1].split(".")||"",n="on";s.includes("once")&&(n="one"),t=l?fe(i):r[i],be(e)[n](a,(e,a)=>{s.includes("prevent")&&e.preventDefault(),s.includes("stop")&&(e.bubble=!1),t.call(r[j],e,a)})}})});let a=new Set;B(n,"[xv-model]").forEach(e=>{if(a.has(e))return;let s=e.getAttribute("xv-model");switch(e.tagName.toLowerCase()){case"input":switch(e.getAttribute("type")){case"checkbox":let i=B(n,`input[type="checkbox"][xv-model="${s}"]`);return void(i.length>1?(i.forEach(e=>{e.addEventListener("change",e=>{let{value:t,checked:a}=e.target,n=r.getData(s);a?n.add(t):n.delete(t)})}),i.forEach(e=>{a.add(e)})):(r.watch(s,(t,a)=>{e.checked=a}),e.addEventListener("change",t=>{let{checked:a}=e;r.setData(s,a)})));case"radio":let l=B(n,`input[type="radio"][xv-model="${s}"]`),o=t();return void l.forEach(e=>{e.setAttribute("name",`radio_${s}_${o}`),e.addEventListener("change",t=>{e.checked&&r.setData(s,e.value)})})}case"textarea":r.watch(s,(t,a)=>{e.value=a}),e.addEventListener("input",t=>{r.setData(s,e.value)});break;case"select":r.watch(s,(t,a)=>{e.value=a}),e.addEventListener("change",t=>{r.setData(s,e.value)});break;default:if(e.xvele){let t=e.__xhear__;t.watch("value",(e,t)=>{r.setData(s,t)}),r.watch(s,(e,a)=>{t.setData("value",a)})}else console.warn("can't xv-model with thie element => ",e)}}),a.clear(),a=null}r.watch(a.watch);let c=Object.assign({},a.data);a.attrs.forEach(t=>{r.watch(t,a=>{e.setAttribute(z(t),a.val)})});let h=Object.keys(c);h.push(...a.attrs),h.push(...Object.keys(a.watch)),(h=new Set(h)).forEach(e=>{/^_.+/.test(e)&&h.delete(e)});let d=r[Z];d?h.forEach(e=>d.add(e)):Object.defineProperty(r,Z,{value:h}),h.has("value")&&Object.defineProperty(e,"value",{get:()=>r.value,set(e){r.value=e}}),Object.keys(c).forEach(e=>{let t=c[e];s(t)||r.setData(e,t)});let p=0;if(n){let t=B(n,"link");t.length?Promise.all(t.map(e=>new Promise(t=>{e.sheet?t():e.onload=(()=>{t(),e.onload=null})}))).then(()=>l(()=>e.setAttribute("xv-ele",1),e.xvid)):p=1}else p=1;p&&l(()=>e.setAttribute("xv-ele",1),e.xvid),r.trigger("renderend",{bubbles:!1})},be=e=>e.__xhear__||new ae(e),ye=e=>be(e)[j];let ve=e=>{if(e instanceof ae)return e;let t;return(t="string"!==r(e)||/\<.+\>/.test(e)?W(e):document.querySelector(e))?ye(t):null};Object.assign(ve,{register:e=>{let a={tag:"",temp:"",attrs:[],data:{},watch:{}};Object.assign(a,e);let r=a.attrs=a.attrs.map(e=>X(e));a.data=i(a.data),a.watch=Object.assign({},a.watch);let s=a.tag=z(a.tag);const n=class extends ae{constructor(...e){super(...e)}};a.proto&&n.prototype.extend(a.proto);const o=class extends HTMLElement{constructor(){super(),delete this.__xhear__;let e=new n(this);Object.defineProperty(this,"xvele",{value:!0}),Object.defineProperty(e,"xvele",{value:!0});let r=this.xvid="xv"+t(),s=Object.assign({},a);l(()=>this.setAttribute("xv-ele",""),r),me(this,s),s.ready&&s.ready.call(e[j]),s.slotchange&&e.$shadow.on("slotchange",t=>s.slotchange.call(e[j],t)),Object.defineProperties(this,{[pe]:{writable:!0,value:0}})}connectedCallback(){this[pe]||a.attached&&a.attached.call(ye(this))}disconnectedCallback(){this[pe]||a.detached&&a.detached.call(ye(this))}attributeChangedCallback(e,t,a){let r=this.__xhear__;a!=r[e=X(e)]&&r.setData(e,a)}static get observedAttributes(){return r.map(e=>z(e))}};Object.assign(a,{XhearElement:o}),de.set(a.tag,a),customElements.define(s,o)},nextTick:l,xdata:e=>u(e)[j],v:5001001,version:"5.1.1",fn:re,isXhear:e=>e instanceof ae,ext:e=>{e({renderEle:me})},all:e=>B(document,e).map(e=>ye(e))}),e.$=ve})(window),(e=>{const t=new Map,a=new Map,r=new Map,s=new Map,n={};let i=!1;const l=new Map;let o={time:100,backups:[]},c={processors:t,loaders:a,bag:r,paths:s,dirpaths:n,errInfo:o,baseUrl:"",tempM:{}};const h=()=>Math.random().toString(32).substr(2);var d=Object.prototype.toString;const p=e=>(e=>d.call(e).toLowerCase().replace(/(\[object )|(])/g,""))(e).search("function")>-1;const u=(()=>{if(null!==document.currentScript.getAttribute("debug"))return setTimeout;if("object"==typeof process&&process.nextTick)return process.nextTick;let e=!1,t=[];return a=>{e||(e=!0,setTimeout(()=>{for(let e=0;e<t.length;e++)t[e]();t=[],e=!1},0)),t.push(a)}})(),f=e=>{let t=(e=(e=e.replace(/(.+)#.+/,"$1")).replace(/(.+)\?.+/,"$1")).match(/(.+\/).*/);return t&&t[1]},g=e=>{let t=[];return e.split(/\//g).forEach(e=>{".."==e&&t.length&&".."!=t.slice(-1)[0]?t.pop():t.push(e)}),t.join("/")},m=f(document.location.href);a.set("css",e=>new Promise((t,a)=>{let r=document.createElement("link");r.rel="stylesheet",r.href=e.link;let s=!1;r.onload=(async()=>{document.head.removeChild(r),t(async e=>(s||e.param.includes("-unAppend")||(s=!0,document.head.appendChild(r)),r))}),r.onerror=(e=>{a({desc:"load link error",target:r,event:e})}),document.head.appendChild(r)})),a.set("json",async e=>{let t=await fetch(e.link);return t=await t.json(),async()=>t}),a.set("wasm",async e=>{let t=await fetch(e.link);t=await t.arrayBuffer();let a=await WebAssembly.compile(t);const r=new WebAssembly.Instance(a);return async()=>r.exports}),a.set("frame",async e=>{let t=document.createElement("iframe");Object.assign(t.style,{position:"absolute","z-index":"-1",border:"none",outline:"none",opacity:"0",width:"0",height:"0"});let{link:a,path:s}=e,n=s.replace(/\.frame$/,"/frame.html"),i=a.replace(s,n);t.src=i;let l=new Map,o=()=>{r.delete(s),document.body.removeChild(t),window.removeEventListener("message",c),c=e=o=null};e.timer=setTimeout(o,1e4);let c,d=a=>new Promise(r=>{let s=h();clearTimeout(e.timer),l.set(s,{res:r}),t.contentWindow.postMessage({type:"drillFrameTask",taskId:s,data:a.data},"*")});return window.addEventListener("message",c=(t=>{let{data:a,taskId:r}=t.data;if(l.has(r)){let e=l.get(r);l.delete(r),e.res(a)}l.size||(e.timer=setTimeout(o,1e4))})),new Promise((e,a)=>{t.addEventListener("load",t=>{e(d)}),t.addEventListener("error",e=>{o(),a()}),document.body.appendChild(t)})}),a.set("js",e=>new Promise((a,s)=>{let n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=e.link,n.addEventListener("load",async()=>{let s,{tempM:n}=c,{type:i,moduleId:l}=n;l&&(r.get(l)||r.set(l,e));let o=t.get(i||"file");if(!o)throw"no such this processor => "+i;s=await o(e),a(s)}),n.addEventListener("error",()=>{s()}),document.head.appendChild(n)})),a.set("mjs",async e=>{let t=await import(e.link);return async()=>t});const b=new Set(["png","jpg","jpeg","bmp","gif","webp"]),y=e=>{let t=a.get(e);return t||(console.log("no such this loader => "+e),t=v),b.has(e)&&(t=w),t},v=async e=>{let t=await fetch(e.link);return t=await t.text(),async()=>t},w=async e=>{if(e.offlineUrl)return async()=>e.offlineUrl;let t=await fetch(e.link),a=await t.blob(),r=URL.createObjectURL(a);return async()=>r},x=e=>/^http/.test(e);let k=async e=>{if(e.param&&e.param.includes("-getLink")&&!i)return Promise.resolve(e.link);let t=r.get(e.path);if(!t){(t={stat:1,dir:e.dir,path:e.path,link:e.link,fileType:e.fileType}).passPromise=new Promise((e,a)=>{t._passResolve=e,t._passReject=a}),r.set(e.path,t);let a=[t.link];const s=e=>{t.stat=4,t._passReject({desc:"load source error",link:a,packData:t})};for(;;)try{t.link=await I({packData:t}),t.getPack=await y(e.fileType)(t)||(async()=>{}),t.stat=3,t._passResolve();break}catch(r){if(t.stat=2,x(e.str))break;let{backups:n}=o;if(!n.length){s();break}{let e=void 0!=t.backupId?t.backupId:t.backupId=-1;if(!(e<n.length)){t.stat=4,s();break}{let r=n[e]||c.baseUrl,i=location.href.replace(/(.+\/).+/,"$1");x(r)||(r=i+r);let l=n[e=++t.backupId];if(!l){s();break}x(l)||(l=i+l),t.link=t.link.replace(new RegExp("^"+r),l),a.push(t.link),await new Promise(e=>setTimeout(e,o.time))}}}}return await t.passPromise,e.param&&e.param.includes("-getLink")&&i?Promise.resolve(t.link):await t.getPack(e)};const j={load:(...e)=>_($(e)),remove(e){let{path:t}=P({str:e});if(r.has(t))return r.delete(t),!0;console.warn(`pack %c${e}`,"color:red","does not exist")},has(e){let{path:t}=P({str:e}),a=r.get(t);return a&&a.stat},config(e){e.baseUrl&&(c.baseUrl=e.baseUrl);let t=e.paths;t&&Object.keys(t).forEach(e=>{/^@.+\/$/.test(e)?n[e]={reg:new RegExp("^"+e),value:t[e]}:s.set(e,t[e])}),c.baseUrl&&e.backups&&e.backups.forEach(e=>o.backups.push(e))},ext(e,t){if(p(e))e(c);else{let a,r=(...e)=>t(e,a,c);switch(e){case"fixUrlObj":a=P,P=r;break;case"load":a=_,_=r;break;case"agent":a=k,k=r;break;case"cacheSource":a=I,I=r}}},cacheInfo:{k:"d_ver",v:""},get offline(){return i},set offline(e){i?console.error("offline mode has been activated"):i=e},debug:{bag:r},version:"3.5.0",v:3005e3},E=(a,r)=>{t.set(a,async e=>{let t=c.tempM.d;return c.tempM={},await r(e,t,{relativeLoad:(...t)=>_($(t,e.dir))})});let s=(e,t)=>{c.tempM={type:a,d:e,moduleId:t}};j[a]||(j[a]=s),e[a]||(e[a]=s)},O=(e,t)=>{l.set(e,async({file:e,packData:a})=>{let r=e,s=await e.text(),n=await t({fileText:s,file:e,relativeLoad:(...e)=>_($(e,a.dir))});return s!==n&&(r=new File([n],e.name,{type:e.type})),r})};let _=e=>{let t,a=new Promise((a,r)=>{let s=[],{length:n}=e,i=n,l=[];e.forEach(async(e,o)=>{let c,h="succeed";await new Promise(e=>u(e)),c=await k(e).catch(t=>{h="error",Object.assign(e,{type:"error",descript:t}),l.push(e)}),s[o]=c,t&&t({id:o,sum:i,ready:i-n+1,stat:h}),--n||(l.length?r(l):a(1==i?c:s),s=null)})});return a.post=function(t){return e.forEach(e=>e.data=t),this},a.pend=function(e){return t=e,this},a},P=e=>{let{str:t}=e;if(r.has(t)){let a=r.get(t);return Object.assign(e,{path:a.path,link:a.link,dir:a.dir}),e}let a=t.split(/\s/).filter(e=>e&&e),i=a.slice(1),l=a[0],o=l.match(/(.+)\?(\S+)$/)||"";o&&(l=o[1],o=o[2]);let{k:h,v:d}=j.cacheInfo;h&&d&&!i.includes("-unCacheSearch")&&(o&&(o+="&"),o+=h+"="+d);let p=s.get(l);if(p)l=p;else for(let e in n){let t=n[e];if(t.reg.test(l)){l=l.replace(t.reg,t.value);break}}let u,b=(e=>{let t,a=e.split("/").pop().match(/(.+)\.(.+)/);return a&&(t=a[2]),t})(l)||"js";if(l=l.replace(new RegExp("\\."+b+"$"),""),u=i.includes("-r")||/^.+:\/\//.test(l)?l:/^\./.test(l)?e.relative?l=e.relative+l:l.replace(/^\.\//,""):c.baseUrl+l,i.includes("-pack")){let e=u.match(/(.+)\/(.+)/);l=u=e&&2 in e?e[1]+"/"+e[2]+"/"+e[2]:`${u}/${u}`}/^.+:\/\//.test(u)||(u=m+u),u=u.replace(/\/\.\//,"/"),l=l.replace(/\/\.\//,"/"),/\.\.\//.test(u)&&(u=g(u),l=g(l));let y=f(u+="."+b),v=o?u+"?"+o:u;return i.includes("-mjs")&&(b="mjs"),Object.assign(e,{link:v,search:o,ori:l,fileType:b,path:u,dir:y,param:i}),e};const $=(e,t)=>{let a=h();return e.map((e,r)=>P({loadId:h(),id:r,str:e,groupId:a,relative:t}))};t.set("file",e=>{}),E("define",async(e,t,{relativeLoad:a})=>{let r={},s={exports:r};if(p(t)){let{path:n,dir:i}=e;t=t(a,r,s,{FILE:n,DIR:i})}return t instanceof Promise&&(t=await t),t||(e=>!(0 in Object.keys(e)))(s.exports)||(t=s.exports),async()=>t}),E("task",(e,t,{relativeLoad:a})=>{if(!p(t))throw"task must be a function";let{path:r,dir:s}=e;return async e=>{return await t(a,e.data,{FILE:r,DIR:s})}}),E("init",(e,t,{relativeLoad:a})=>{if(!p(t))throw"init must be a function";let r,{path:s,dir:n}=e,i=0;return async e=>i?r:(r=await t(a,e.data,{FILE:s,DIR:n}),i=1,r)}),O("css",async({fileText:e,relativeLoad:t})=>{let a=e.match(/@import ["'](.+?)["']/g);a&&await Promise.all(a.map(async a=>{let r=a.replace(/@import ["'](.+?)["']/,"$1"),s=await t(`${r} -getLink`);e=e.replace(a,`@import "${s}"`)}));let r=e.match(/url\((.+?)\)/g);return r&&await Promise.all(r.map(async a=>{let r=a.replace(/url\((.+?)\)/,"$1").replace(/["']/g,"");if(/(^http:)|(^https:)/.test(r))return Promise.resolve("");let s=await t(`${r} -getLink`);e=e.replace(a,`url("${s}")`)})),e}),O("mjs",async({fileText:e,relativeLoad:t})=>{let a=e.match(/import .+ from ['"](.+?)['"];/g);a&&await Promise.all(a.map(async a=>{let r=a.match(/(import .+ from) ['"](.+?)['"];/,"$1");if(r){let s=r[2],n=await t(`${s} -getLink`);e=e.replace(a,`${r[1]} "${n}"`)}}));let r=e.match(/import\(.+?\)/g);return r&&await Promise.all(r.map(async a=>{let r=a.replace(/import\(["'](.+?)['"]\)/,"$1"),s=await t(`${r} -getLink`);e=e.replace(a,`import("${s}")`)})),e});let D,S=new Promise((t,a)=>{const r=e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.msIndexedDB;if(r){let e=r.open("drill-cache-db",j.cacheInfo.v||1);e.onupgradeneeded=(e=>{let t=e.target.result;t.objectStoreNames.contains("files")?(t.deleteObjectStore("files"),t.createObjectStore("files",{keyPath:"path"})):t.createObjectStore("files",{keyPath:"path"})}),e.onsuccess=(e=>{D=e.target.result,t()})}else a("rubish browser no indexDB")}),I=async({packData:e})=>{if(!i)return e.link;await S;let t=await L(e.path);if(!t){let a=await fetch(e.link);if(200!=a.status)throw{type:"cacheSource",desc:"statusError",status:a.status};let r=a.headers.get("Content-Type").replace(/;.+/,""),s=e.path.replace(/.+\//,""),n=await a.blob();t=new File([n],s,{type:r}),await A(e.path,t)}let a=l.get(e.fileType);return a&&(t=await a({file:t,packData:e})),e.offlineFile=t,e.offlineUrl=URL.createObjectURL(t)};const L=e=>new Promise((t,a)=>{let r=D.transaction(["files"],"readonly").objectStore("files").get(e);r.onsuccess=(()=>{t(r.result&&r.result.data)}),r.onerror=(t=>{a(),console.error(`error load ${e}`,t)})}),A=(e,t)=>new Promise((a,r)=>{let s=D.transaction(["files"],"readwrite").objectStore("files").put({path:e,data:t});s.onsuccess=(()=>{a({stat:1}),console.log(`save ${e} succeed`)}),s.onerror=(t=>{a({stat:0}),console.error(`save (${e}) error`,t)})});Object.defineProperty(c,"main",{value:{get agent(){return k},get load(){return _},get fixUrlObj(){return P},get toUrlObjs(){return $},get setProcessor(){return E}}}),e.load||(e.load=j.load);let T=document.currentScript;if(!T&&(T=document.querySelector(["drill-cache"])),T){let e=T.getAttribute("drill-cache");e&&(j.cacheInfo.v=e)}let C=e.drill;Object.defineProperty(e,"drill",{get:()=>j,set(e){p(e)?u(()=>e(j)):console.error("drill type error =>",e)}}),C&&u(()=>C(j))})(window);const t=()=>Math.random().toString(32).substr(2),a=e=>Object.prototype.toString.call(e).toLowerCase().replace(/(\[object )|(])/g,"");let r="";Symbol("currentPages");const s=Symbol("navigateData"),n=Symbol("pageId"),i=Symbol("pageOptions");function l(e){let t=[];return e.currents.object.forEach((e,a)=>{0!=a&&(delete e.pageId,t.push(e))}),t}function o(e,t){t.currents.push(...e),$.nextTick(()=>{t.currentPages.forEach(e=>e.style.transition="none"),setTimeout(()=>t.currentPages.forEach(e=>e.style.transition=""),100)})}const c=(e,t)=>{let a=e,r=!1;e instanceof Element||(r=!0,(a=document.createElement("div")).setAttribute("xd-page-anime",e),$("body").push(a));let s={},n=getComputedStyle(a);["opacity"].forEach(e=>{s[e]=n[e]});let i={t:t||"2d"};if(n.transform&&"none"!=n.transform&&("matrix3d"==n.transform&&(i.t="3d"),i.a=n.transform.replace(/matrix\((.+)\)/,"$1").split(",").map(e=>parseFloat(e.trim()))),"2d"!=i.t||i.a?"3d"!=i.t||i.a||(i.a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]):i.a=[1,0,0,1,0,0],"2d"==i.t){let e=i.a;i.t="3d",i.a=[e[0],e[1],0,0,e[2],e[3],0,0,0,0,1,0,e[4],e[5],0,1]}return r&&a.remove(),s.transform=i,s},h=e=>e.changedTouches?e.changedTouches[0]:e.targetTouches?e.targetTouches[0]:e.touches[0],d=e=>{if("slide"!=e.router)return;(e=>{const t="xd-app-history-"+location.pathname;let a=sessionStorage.getItem(t);(a=a?JSON.parse(a):{history:[]}).history.length&&o(a.history,e),e.on("navigate",(r,s)=>{let{currentPage:n}=e,{animeParam:i}=n;switch(s.type){case"to":a.history.push({src:s.src,data:s.data,animeParam:i});break;case"replace":a.history.splice(-1,1,{src:s.src,data:s.data,animeParam:i});break;case"back":a.history.splice(-s.delta)}sessionStorage.setItem(t,JSON.stringify(a))})})(e);const a="_left"+t(),r="_right"+t();$("head").push(`<style>#${a},#${r}{position:fixed;z-index:10000;left:0;top:0;width:20px;height:100%;background-color:rgba(255,0,0,0);}#${r}{left:auto;right:0;}</style>`);let s=$(`<div id="${a}"></div>`);$("body").push(s);let n=[];const i=()=>{if(n.length=0,e.currents.length<=1)return;let t=e.currents.map(e=>{let t=e.object;return t.page=e._page,t}),a=t.length-1;t.forEach((e,t)=>{let{page:r}=e,{animeParam:s}=r,i=s.back;if(t!=a){let e=a-t-2<0?s.current:i[a-t-2];e&&n.push({currentAnimeParam:c(i[a-t-1]),nextAnimeParam:c(e),page:r})}else n.push({currentAnimeParam:c(r.animeParam.current),nextAnimeParam:c(r.animeParam.front),page:r})})};let l,d,p=e.width;s.on("touchstart",e=>{if(e.preventDefault(),!n.length)return;let t=h(e.originalEvent);d=l=t.clientX,n.forEach(e=>{e._beforeStyle=e.page.attrs.style,e.page.style.transition="none"})});let u=!1;s.on("touchmove",e=>{if(e.preventDefault(),!n.length)return;let t=h(e.originalEvent).clientX,a=Math.abs(t-l)/p;n.forEach(e=>{let t=(e=>{let t=Object.assign({},e),{transform:a}=e;switch(a.t){case"2d":t.transform=`matrix(${a.a.join(",")})`;break;case"3d":t.transform=`matrix3d(${a.a.join(",")})`}return t})(((e,t,a)=>{let r={};Object.keys(e).forEach(s=>{if("transform"===s)return;let n=e[s].replace(/[\d\.]+(\D*)/,"$1"),i=parseFloat(e[s]),l=parseFloat(t[s]);r[s]=(l-i)*a+i+n});let s=e.transform,n=t.transform;if(s&&n){if(s.t!==n.t)return void console.error("animeByPrecent transform type unequal");let e=r.transform={t:s.t,a:[]};s.a.forEach((t,r)=>{let s=n.a[r];e.a.push((s-t)*a+t)})}return r})(e.currentAnimeParam,e.nextAnimeParam,a));Object.assign(e.page.style,t)}),u=t-d>0&&a>.1,d=t}),s.on("touchend",t=>{t.preventDefault(),n.length&&(n.forEach(e=>{e.page.attrs.style=e._beforeStyle}),u&&e.back())}),e.watch("currents",e=>{setTimeout(()=>i(),100)}),setTimeout(()=>i(),100)};drill.ext(e=>{let{main:c}=e;$.ext(({renderEle:e})=>{const h=async({defaults:e,packData:t,options:s,relativeLoad:n})=>{(e=>a(e).includes("function"))(s)&&(s=s(n,{DIR:t.dir,FILE:t.path}))instanceof Promise&&(s=await s),Object.assign(e,s);let i=t.path.match(/.+\/(.+)/)[1];i=i.replace(/\.js$/,"");let l="";if(e.temp){l=/\</.test(e.temp)?e.temp:!0===e.temp?await n(`./${i}.html`):await n(`${e.temp}`);let t=e.css;t&&(t=!0===e.css?await n(`./${i}.css -getLink`):await n(`${e.css} -getLink`))&&(l=`<link rel="stylesheet" href="${t}">\n`+l),r&&(l=`<link rel="stylesheet" href="${r}" />`+l)}e.temp=l};c.setProcessor("Component",async(e,t,{relativeLoad:r})=>{let s={temp:!1,css:!1,hostcss:"",ready(){}};if(await h({defaults:s,packData:e,options:t,relativeLoad:r}),s.hostcss){let e=s.ready,t="string"==a(s.hostcss)?[s.hostcss]:s.hostcss;s.ready=async function(...a){let s=this.ele.getRootNode();await Promise.all(t.map(async e=>{if(e=await r(e+" -getLink"),!s.querySelector(`link[href="${e}"]`)){let t=$(`<link rel="stylesheet" href="${e}">`);s===document?s.querySelector("head").appendChild(t.ele):s.appendChild(t.ele)}})),e.apply(this,a)}}$.register(s)});let u=$("<style>xd-page{display:block;}</style>");$("head").push(u);const f=Symbol("_preparing"),g=Symbol("_preparing_resolve"),m=Symbol("page_state");c.setProcessor("Page",async(e,t,{relativeLoad:a})=>{let r={temp:!0,css:!1,watch:{},data:{}};return await h({defaults:r,packData:e,options:t,relativeLoad:a}),async()=>r}),$.register({tag:"xd-page",temp:!1,proto:{get pageStat(){return this[m]},get pageId(){return this[n]},get app(){return this.parents("xd-app")[0]},set animeParam(e){this._animeParam=e},get animeParam(){let e=this._animeParam;if(!e){let{app:t}=this;t&&(e=t.animeParam)}return e},get params(){let e=/\?(.+)/.exec(this.src);if(e){let t={};return e[1].split("&").forEach(e=>{let[a,r]=e.split("=");a&&r&&(t[a]=r)}),t}},navigate(e){let t,r=this;do{if(t=r.app){if(r.ele!==this.ele)return void r.navigate(e);break}{let e=r.$host;if(!e||!e.is("xd-page"))return void console.warn("this page no app =>",this);r=r.$host}}while(r);let s={src:""};switch(a(e)){case"object":Object.assign(s,e);break;case"string":s.src=e}if(s.self=this,"back"!==s.type){let e=this.src;if(e){let t=/(.+\/)(.+)/.exec(e),a=s.src;if(t){let e=c.toUrlObjs([a],t[1]);e&&(e=e[0]),a=e.ori,e.search&&(a+=".js?"+e.search)}s.src=a}}return t._navigate(s)},back(e=1){return this.navigate({type:"back",delta:e})}},data:{src:"",show:!0},attrs:["src"],watch:{async src(t,a){if(!a)return;if("unload"!==this.pageStat&&"preparing"!==this.pageStat)throw{target:this,desc:"xd-page can't reset src"};let r,n;this[f]&&await this[f],this[m]="loading";try{r=await load(a+" -r")}catch(t){let r=t[0].descript;this[m]="error";let s=await load(a+" -r -getLink");throw e(this.ele,{temp:p.get404({path:s,src:a}),attrs:[],watch:{}}),r}this[i]=r,e(this.ele,Object.assign({attrs:[],watch:{}},r)),this[m]="finish",this[s]&&(n=this[s],delete this[s]),r.ready&&r.ready.call(this,{data:n}),this.emit("page-ready"),this.watch("show",(e,t)=>{t?r.onShow&&r.onShow.call(this):r.onHide&&r.onHide.call(this)},!0)}},ready(){this[n]=t(),this[m]="unload"},detached(){this[m]="destory",this[i]&&(this[i].destory&&this[i].destory.call(this),this.emit("page-destory"))}}),$.fn.extend({get $page(){let{$host:e}=this;for(;e.$host;)e=e.$host;return e},get $app(){let{$page:e}=this;if(e)return e.parents("xd-app")[0];console.warn("no app")}});$.register({tag:"xd-app",data:{currents:[],_animeParam:{back:["back"],current:"active",front:"front"},launched:!1,visibility:document.hidden?"hide":"show",router:0},watch:{currents(e,t){if(!t.length)return;let a=e.old,r=t.length-1;if(t.forEach((e,a)=>{let{animeParam:n,data:i,src:l,_page:o}=e;clearTimeout(e._nextPageAnimeTimer);let c=o;c||(e._page=c=$({tag:"xd-page",src:l}),c[s]=i,this.push(c)),"unload"!==c.pageStat||c._preparing||(c[m]="preparing",c[f]=new Promise(e=>c[g]=(()=>{c[g]=c[f]=null,e()}))),a>=r-1&&c[f]&&c[g](),e.pageId||(e.pageId=c.pageId);let{current:h,front:d,back:p}=n||c.animeParam;a<r?(c.attrs["xd-page-anime"]=p[r-1-a]||p.slice(-1)[0],c.show=!1):r==a&&(c.attrs["xd-page-anime"]||1==t.length?(c.attrs["xd-page-anime"]=h,c.show=!0):(c.attrs["xd-page-anime"]=d,e._nextPageAnimeTimer=setTimeout(()=>{c.attrs["xd-page-anime"]=h,c.show=!0},50)))}),a&&a.length){let e=a.filter(e=>!t.find(t=>t.pageId===e.pageId));if(e&&e.length){let t=this.filter(t=>!!e.find(e=>e.pageId===t.pageId));t&&t.length&&t.forEach(e=>{let{front:t}=e.animeParam;e.attrs["xd-page-anime"]=t;let a=t=>{e.ele.removeEventListener("transitionend",a),e.remove(),a=null};e.ele.addEventListener("transitionend",a),setTimeout(()=>a&&a(),1e3)})}}}},attrs:["router"],proto:{get animeParam(){return this._animeParam},set animeParam(e){this._animeParam=e},get currentPage(){return this.currents.slice(-1)[0]._page},get currentPages(){return this.currents.map(e=>e._page)},_navigate(e){let t={self:"",type:"to",delta:1,src:"",data:null};if(Object.assign(t,e),t.data&&(t.data=JSON.parse(JSON.stringify(t.data))),t.self){let e=this.currents.findIndex(e=>e._page===t.self);e>-1&&e<this.currents.length-1&&this.currents.splice(e+1)}return new Promise((e,a)=>{switch(t.type){case"to":this.currents.push({src:t.src,data:t.data});break;case"replace":this.currents.splice(-1,1,{src:t.src,data:t.data});break;case"back":if(this.currents.length<=1)return;t.delta>=this.currents.length&&(t.delta=this.currents.length-1),this.currents.splice(-t.delta)}$.nextTick(()=>this.emitHandler("navigate",Object.assign({},t)))})},back(e=1){this.currentPage.back(e)}},ready(){$.nextTick(()=>{let e=()=>{let t=this.$("xd-page");this.currents=[{src:t.src,data:{},_page:t,animeParam:t.animeParam,pageId:t.pageId}],this.launched=!0,e=null};this.$("xd-page")?e():this.one("page-ready",e)}),window.addEventListener("visibilitychange",e=>{this.visibility=document.hidden?"hide":"show"});let e=(t,a)=>{a&&(this.unwatch("launched",e),d(this),(e=>{if("router"!=e.router&&1!=e.router)return;let t;history.state&&o((t=history.state).history,e),e.on("navigate",(r,s)=>{console.log("navigate => ",r,s);let{currentPage:n}=e,{animeParam:i,src:o}=n,c=l(e);switch(s.type){case"to":t={history:c},s._popstate_forward||history.pushState(t,"",`#${o}`);break;case"replace":t={history:c},s._popstate_replace||history.replaceState(t,"",`#${o}`);break;case"back":s._popstate_back||(a=1,history.go(-s.delta))}console.log("navigate =>",s)});let a=0;window.addEventListener("popstate",r=>{let s=t&&t.history||[],n=r.state&&r.state.history||[];if(location.hash.replace(/^\#/,"")&&!r.state){let t=location.hash.replace(/^\#/,"");return e.currents.push({src:t}),history.replaceState({history:l(e)},"",`#${t}`),void $.nextTick(()=>e.emitHandler("navigate",{type:"to",src:t,_popstate_forward:!0}))}if(s.length>n.length){if(a)return void(a=0);e._navigate({type:"back",delta:s.length-n.length,_popstate_back:!0})}else{let t=n.slice(-(n.length-s.length));if(t.length){e.currents.push(...t);let a=n.slice(-1)[0];$.nextTick(()=>e.emitHandler("navigate",{type:"to",src:a.src,_popstate_forward:!0}))}}t=r.state});let r=location.hash.slice(1);r&&!history.state&&(history.replaceState(null,"",""),$.nextTick(()=>{e._navigate({src:r})}))})(this),e=null)};this.watch("launched",e)}})})}),drill.config({paths:{"@ofa/":"https://kirakiray.github.io/ofa_lib/dollar2/"}});const p={set globalcss(e){r=e},get globalcss(){return r},drill:drill,$:$,get config(){return drill.config},get offline(){return drill.offline},set offline(e){this.drill.offline=e},get404:e=>`\n            <div style="display:flex;flex-direction:column;justify-content:center;align-items:center;height:300px;">\n                <div style="margin-bottom:16px;width:45px;height:45px;font-size:30px;line-height:45px;border-radius:32px;text-align:center;font-weight:bold;background-color:#fb4747;color:#fff;">!</div>\n                <div style="font-size:13px;color:#888;text-align:center;">\n                Failed to load<br>\n                path: <a style="color:#477efd;text-decoration: underline;" href="${e.path}" target="_blank">${e.path}</a> <br>\n                src: <span style="color:#477efd;text-decoration: underline;">${e.src}</span>\n                </div>\n            </div>\n            `,v:2004002,version:"2.4.2"};let u=e.ofa;const f=e=>a(e).includes("function")&&e();Object.defineProperties(e,{ofa:{get:()=>p,set(e){f(e)}}}),u&&f(u)})(window);