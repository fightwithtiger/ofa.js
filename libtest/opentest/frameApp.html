<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>frame app</title>
    <script src="../../dist/ofa.js"></script>
</head>

<body>
    <o-app id="target_app"></o-app>
    <div>
        <input type="text" id="msg_inputer" value="return!!">
        <button onclick="postbackdata()">返回数据</button>
    </div>
    <br>

    <div id="consoler" style="border:#aaa solid 1px;padding:20px;">
        接受到的最后的数据↓（此页面可刷新） <button onclick="location.reload()">刷新</button> <br> </div>
    <script>
        $("#target_app").on("message", e => {
            // 接受到信息
            console.log("message => ", e.data);
            $("#consoler").html += `${e.data}<br>`;
            $("#msg_inputer").value = 'return ' + e.data + "!!!";
        });

        function postbackdata() {
            $("#target_app").postback($("#msg_inputer").value);
        }

        setInterval(() => {
            if (!opener || opener.closed) {
                close();
            }
        }, 1000);
    </script>
</body>

</html>